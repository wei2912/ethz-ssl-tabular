\documentclass{article}

\usepackage[nonatbib,final]{neurips}
\usepackage[backend=biber,style=numeric-comp,doi=false,url=false]{biblatex}
\setlength\bibitemsep{0.5\baselineskip}
\usepackage{bm}
\usepackage{caption}
\usepackage[inkscapelatex=false]{svg}

\addbibresource{references.bib}
\svgpath{../plots/}

\newcommand{\todo}{\bf \color{blue} [TODO]~}

\makeatletter
\renewcommand{\@noticestring}{
  \centering

}
\makeatother

\input{extra_pkgs}

\usepackage{physics}
\usepackage{mathtools}
\DeclarePairedDelimiter\p{(}{)}
\DeclarePairedDelimiter\n{|}{|}
\DeclarePairedDelimiter\B{[}{]}

\title{Experiments on Self-Training with Models for Tabular Data}

\author{
    Wei En, Ng \\
    National University of Singapore \\
    \texttt{\href{mailto:ngwe@u.nus.edu}{ngwe@u.nus.edu}}
}

\begin{document}

\maketitle

\section{Introduction}

This report seeks to study self-training \cite{wei2022theoretical} on tabular data,
where tree-based models often outperform deep learning methods significantly in the
typical supervised learning setting \cite{shwartz-ziv2021tabular,grinsztajn2022why}.%
\footnote{
  Some recent works \cite{gorishniy2023tabr} have claimed to develop deep learning
  models that can outperform tree-based methods such as XGBoost \cite{chen2016xgboost}
  on tabular data.
}

Several general observations have been made on the performance of these methods:
\begin{enumerate}
    \item ($\bm{-}$) Increasing the random search budget for hyperparameters does
    not benefit NNs. \cite{grinsztajn2022why}
    \item ($\bm{-}$) NNs continue to do poorly on datasets with only numerical
    features, although the performance gap is slightly reduced compared to datasets with
    categorical features. \cite{grinsztajn2022why}
    \item ($\bm{+}$) Increasing the number of training samples might reduce the
    performance gap. \cite{grinsztajn2022why}
\end{enumerate}

Furthermore, low-data regimes for tabular data do not appear to be well-studied,
possibly because tree-based models seem to reach near-optimal performance with low
training dataset sizes.\footnote{
  See Figure \ref{fig:ul_split_vs_l_split} where \texttt{l\_split
  = 0.25} (corr. to 500 samples) usually produces test accuracies $\pm 5\%$ within that
  of \texttt{l\_split = 1} (corr. to 2k samples) across different model/dataset
  combinations.
  It should be noted that the original datasets are often much bigger with at least 10k
  samples, as listed in Table \ref{tab:datasets}.
}

\section{Methodology}\label{sec:met}

\subsection{Datasets}

The tabular datasets used for our experiments are selected from benchmarks used in

\begin{table}[htbp]
  \centering
  \caption{Datasets employed in our experiments.}
  \begin{tabular}{rccccc}
    \toprule
    & \textbf{Samples} & \multicolumn{3}{c}{\textbf{Features}} & \textbf{Classes} \\
    \cmidrule(lr){3-5}
    & & Numerical & Categorical & Total \\
    \midrule
    \small\texttt{jannis} & 57.5k & 54 & - & 54 & 2 \\
    \small\texttt{gas-drift}%
    \footnote{The full name is \texttt{gas-drift-different-concentrations}.}
    & 13.9k & 129 & - & 129 & 6 \\
    \small\texttt{higgs} & 98k & 28 & - & 28 & 2 \\
    \small\texttt{covertype} & 581k & 10 & 44 & 54 & 7 \\
    \bottomrule
  \end{tabular}
  \label{tab:datasets}
\end{table}

\section{Results}\label{sec:res}

\texttt{l\_split} and \texttt{ul\_split} is the proportion of L and UL samples
selected as the training dataset (out of a total of 2k samples) resp..

\begin{figure}[htbp]
  \centering
  \includesvg[width=\columnwidth]{test_accs/jannis_ul_split_vs_l_split.svg}
  \includesvg[width=\columnwidth]{test_accs/gas-drift-different-concentrations_ul_split_vs_l_split.svg}
  \includesvg[width=\columnwidth]{test_accs/higgs_ul_split_vs_l_split.svg}
  \includesvg[width=\columnwidth]{test_accs/covertype_ul_split_vs_l_split.svg}
  \caption{Test accuracy (acc.) across different splits.}
  \label{fig:ul_split_vs_l_split}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includesvg[width=\columnwidth]{test_accs/jannis_test_acc_vs_ul_split_low.svg}
  \includesvg[width=\columnwidth]{test_accs/gas-drift-different-concentrations_test_acc_vs_ul_split_low.svg}
  \includesvg[width=\columnwidth]{test_accs/higgs_test_acc_vs_ul_split_low.svg}
  \includesvg[width=\columnwidth]{test_accs/covertype_test_acc_vs_ul_split_low.svg}
  \caption{
    Test accuracy (acc.) across multiple splits in the low unlabelled (UL) data regime.
  }
  \label{fig:test_acc_vs_ul_split_low}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includesvg[width=\columnwidth]{test_accs/jannis_test_acc_vs_ul_split_high.svg}
  \includesvg[width=\columnwidth]{test_accs/gas-drift-different-concentrations_test_acc_vs_ul_split_high.svg}
  \includesvg[width=\columnwidth]{test_accs/higgs_test_acc_vs_ul_split_high.svg}
  \includesvg[width=\columnwidth]{test_accs/covertype_test_acc_vs_ul_split_high.svg}
  \caption{
    Test accuracy (acc.) across multiple splits in the high unlabelled (UL) data regime.
  }
  \label{fig:test_acc_vs_ul_split_high}
\end{figure}

\begin{table}[htbp]
  \centering
  \caption{
    Test accuracy (acc.) over five trials with mean and standard deviation.
    Within each matrix: from left to right, \texttt{ul\_split = 0, 0.25}; from top to
    bottom, \texttt{l\_split = 0.025, 0.25}.
  }
  \begin{tabular}{rccc}
    \toprule
    & \texttt{hgbt} & \texttt{mlp} & \texttt{random-forest} \\
    \midrule
    \small\texttt{jannis}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $62.7 \pm 6.1$ & $62.6 \pm 4.1$ \\
        $71.9 \pm 1.6$ & $71.0 \pm 2.1$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $64.7 \pm 4.4$ & $63.2 \pm 7.6$ \\
        $70.0 \pm 1.0$ & $70.7 \pm 0.9$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $66.1 \pm 3.9$ & $62.1 \pm 3.8$ \\
        $71.6 \pm 1.6$ & $69.8 \pm 1.9$ \\
      \end{tabular}
    \end{minipage} \\ \addlinespace
    \small\texttt{gas-drift}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $65.3 \pm 3.7$ & $64.5 \pm 2.2$ \\
        $94.7 \pm 0.4$ & $95.0 \pm 0.7$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $76.1 \pm 2.9$ & $66.0 \pm 7.0$ \\
        $97.0 \pm 0.1$ & $97.2 \pm 0.4$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $67.5 \pm 3.4$ & $64.4 \pm 5.3$ \\
        $93.1 \pm 0.8$ & $92.9 \pm 1.3$ \\
      \end{tabular}
    \end{minipage} \\ \addlinespace
    \small\texttt{higgs}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $54.8 \pm 2.1$ & $53.0 \pm 1.8$ \\
        $65.6 \pm 1.7$ & $64.0 \pm 1.2$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $52.1 \pm 2.7$ & $51.5 \pm 2.3$ \\
        $54.9 \pm 2.9$ & $53.3 \pm 3.3$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $53.8 \pm 2.7$ & $51.5 \pm 3.2$ \\
        $65.8 \pm 0.9$ & $62.5 \pm 1.4$ \\
      \end{tabular}
    \end{minipage} \\ \addlinespace
    \small\texttt{covertype}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $52.6 \pm 2.4$ & $52.0 \pm 3.8$ \\
        $68.1 \pm 0.8$ & $67.4 \pm 1.2$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $49.8 \pm 2.4$ & $42.2 \pm 6.9$ \\
        $59.7 \pm 6.2$ & $62.5 \pm 1.3$ \\
      \end{tabular}
    \end{minipage}
    & \begin{minipage}[b]{0.25\columnwidth}
      \centering
      \begin{tabular}{r@{\hskip 0.1in}l}
        $52.8 \pm 2.6$ & $45.0 \pm 2.6$ \\
        $69.3 \pm 1.3$ & $68.4 \pm 1.2$ \\
      \end{tabular}
    \end{minipage} \\
    \bottomrule
  \end{tabular}
  \label{tab:test_acc_summary}
\end{table}

\clearpage
\appendix
\section{Hyperparameter Sweep Plots}

\begin{figure}[htbp]
  \centering
  \includesvg[width=0.8\columnwidth]{sweep_pareto/jannis_hgbt.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/jannis_mlp.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/jannis_random-forest.svg}
  \caption{
    Harmonic mean of test accuracy (acc.) over five splits, across different
    hyperparameter sweeps on \texttt{jannis}.
  }
  \label{fig:sweep_pareto_jannis}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includesvg[width=0.8\columnwidth]{sweep_pareto/gas-drift-different-concentrations_hgbt.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/gas-drift-different-concentrations_mlp.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/gas-drift-different-concentrations_random-forest.svg}
  \caption{
    Harmonic mean of test accuracy (acc.) over five splits, across different
    hyperparameter sweeps on \texttt{gas-drift}.
  }
  \label{fig:sweep_pareto_gas-drift-different-concentrations}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includesvg[width=0.8\columnwidth]{sweep_pareto/higgs_hgbt.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/higgs_mlp.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/higgs_random-forest.svg}
  \caption{
    Harmonic mean of test accuracy (acc.) over five splits, across different
    hyperparameter sweeps on \texttt{higgs}.
  }
  \label{fig:sweep_pareto_higgs}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includesvg[width=0.8\columnwidth]{sweep_pareto/covertype_hgbt.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/covertype_mlp.svg}
  \includesvg[width=0.8\columnwidth]{sweep_pareto/covertype_random-forest.svg}
  \caption{
    Harmonic mean of test accuracy (acc.) over five splits, across different
    hyperparameter sweeps on \texttt{covertype}.
  }
  \label{fig:sweep_pareto_covertype}
\end{figure}

\clearpage
\printbibliography

\end{document}
